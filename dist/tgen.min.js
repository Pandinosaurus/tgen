/**
 * seamless-texture-generator - Seamless texture generator
 * 
 * @version v1.1.24
 * @link https://github.com/schalkt/tgen/
 * @license MIT
 */
var SeamlessTextureGenerator={version:"1.1.24",defaults:{},effects:{},filters:[],functions:[],blends:{},shapes:{},colormaps:{},events:{beforeEffect:{},afterEffect:{},beforeRender:{},afterRender:{}},config:{historyLast:15,historyName:"history",historyList:[]},blendSafe:["average","lighten","linearburn","linearlight","difference","difference-invert","screen","lineardodge","lineardodge-invert","opacity","exclusion"],blendFlat:["lighten","screen","opacity"],effect:function(e,t,r){this.defaults[e]=t,this.effects[e]=r},function:function(e,t,r){this.functions.push(e),this.defaults[e]=t,this.effects[e]=r},filter:function(e,t,r){this.filters.push(e),this.defaults[e]=t,this.effects[e]=r},event:function(e,t,r){null!=this.events[e]&&(this.events[e][t]=r)},blend:function(e,t){this.blends[e]=t},shape:function(e,t){this.shapes[e]=t},colormap:function(e,t){this.colormaps[e]=t},init:function(c,o,e){function s(){null==c&&(c=256),c<1&&(c=256),o<1&&(o=256),2048<c&&(c=2048),2048<o&&(o=2048),null==o&&(o=c),r=(c+o)/2}var u=this,i=[],t={},l=0,r=null,d={shape:u.shapes,effects:Object.keys(u.effects),layers:[],normalize:e||"limitless"};function f(e,t){var r,n={};for(r in e)n[r]=e[r];for(r in t)n[r]=t[r];return n}function n(e){return void 0===e&&(e=255),!0===e&&(e=128+d.randIntSeed(0,128)),[d.randIntSeed(0,255),d.randIntSeed(0,255),d.randIntSeed(0,255),e]}s(),d.log=function(){if(this.debug&&0<arguments.length){for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[t]);console.log(e)}},d.clear=function(){return d.texture.clear(),d.layers=[],i=[],l=0,t.start=(new Date).getTime(),d},d.buffer=function(e){this.data=null,this.debug=!1,this.components=4,this.width=c,this.height=o,this.wha=(this.width+this.height)/2,this.background=[0,0,0,255],"object"==typeof e&&(this.background=e),this.pixels=function(){return this.width*this.height},this.size=function(){return this.data.length},this.export=function(e,t){e=void 0!==e?e:d.normalize;var r,n=(t=t||this.data).length;switch(e){case"limitless":for(r=new Float32Array(n);n--;)r[n]=t[n];break;case"clamped":for(r=new Uint8ClampedArray(n);n--;)r[n]=t[n];break;case"pingpong":for(r=new Uint8ClampedArray(n);n--;)r[n]=d.calc.pingpong(t[n],0,255);break;case"compress":r=new Uint8ClampedArray(n);for(var a=t[0],i=t[0],o=n;o--;)t[o]&&(a=Math.min(a,t[o]),i=Math.max(i,t[o]));a=Math.floor(a);for(var s=255/((i=Math.ceil(i))-a);n;)r[n-1]=t[n-1],r[n-2]=(t[n-2]-a)*s,r[n-3]=(t[n-3]-a)*s,r[n-4]=(t[n-4]-a)*s,n-=4}return r},this.clear=function(e){this.data=new Float32Array(this.width*this.height*this.components),null==e&&(e=this.background);for(var t=this.size();t;)this.data[t-1]=e[3],this.data[t-2]=e[2],this.data[t-3]=e[1],this.data[t-4]=e[0],t-=this.components},this.pattern=function(e,t){var r,n,a=e/t;return t<=e?n=e-(r=Math.floor(a)*t):e<0?(r=Math.ceil(a)*t,t<=(n=t-Math.abs(e-r))?n-=t:n):void 0},this.offset=function(e,t){return e=Math.round(e),t=Math.round(t),(e<0||e>=this.width)&&(e=this.pattern(e,this.width)),(t<0||t>=this.height)&&(t=this.pattern(t,this.height)),t*this.width*this.components+e*this.components},this.set=function(e,t,r){var n=this.offset(e,t);this.data[n]=r[0],this.data[n+1]=r[1],this.data[n+2]=r[2],this.data[n+3]=r[3]},this.get=function(e,t){var r=this.offset(e,t);return[this.data[r],this.data[r+1],this.data[r+2],this.data[r+3]]},this.canvas=function(e){for(var t=this.size(),r=e.getContext("2d").getImageData(0,0,this.width,this.height).data;t--;)d.texture.data[t]=r[t]},null===this.data&&this.clear()},d.texture=new d.buffer,d.layerCopy=function(e){for(var t=[],r=(e=this.layers[e]).length;r--;)t[r]=e[r];return t},d.clone=function(e,t){for(var r in t)"object"==typeof t[r]&&null!==t[r]&&e[r]?this.clone(e[r],t[r]):e[r]=t[r]},d.minMaxNormalize=function(e,t){return{min:Math.min(e,t),max:Math.max(e,t)}},d.randInt=function(e,t,r){var n=d.minMaxNormalize(e,t);return e=n.min,t=n.max,mul=!0===r?(e=Math.round(e/2),t=Math.round(t/2),2):1,mul*(Math.floor(Math.random()*(t-e+1))+e)},d.randIntSeed=function(e,t,r){var n=d.minMaxNormalize(e,t);return e=n.min,t=n.max,mul=!0===r?(e=Math.round(e/2),t=Math.round(t/2),2):1,mul*(Math.floor(d.calc.randomseed()*(t-e+1))+e)},d.randReal=function(e,t){var r=d.minMaxNormalize(e,t);return e=r.min,t=r.max,Math.random()*(t-e)+e},d.randRealSeed=function(e,t){var r=d.minMaxNormalize(e,t);return e=r.min,t=r.max,d.calc.randomseed()*(t-e)+e},d.randByArray=function(e,t){return"object"==typeof e&&(e=null!=t?d.randReal(e[0],e[1]):d.randInt(e[0],e[1])),e},d.randByArraySeed=function(e,t,r){return"object"==typeof e&&(e=null!=t?d.randRealSeed(e[0],e[1]):d.randIntSeed(e[0],e[1],r)),e},d.randItem=function(e){var t=e.length;return e[d.randIntSeed(0,t-1)]};var h=function(e){var t,r=0;for(var n in e)d.randRealSeed(0,1)<1/++r&&(t=n);return t};function p(e,t,r){if(void 0!==r&&(t=r(t)),t.count&&"object"==typeof t.count&&(t.count=d.randIntSeed(t.count[0],t.count[1])),t.level&&"object"==typeof t.level&&(t.level=d.randIntSeed(t.level[0],t.level[1])),t.opacity&&"object"==typeof t.opacity&&(t.opacity=d.randIntSeed(t.opacity[0],t.opacity[1])),"random"===t.blend&&(t.blend=h(u.blends)),"object"==typeof t.blend){var n=t.blend.length;t.blend=t.blend[d.randIntSeed(0,n-1)]}return void 0!==t.blend?d.point.blend=t.blend:d.point.blend="",t.rgba&&(t.rgba=d.rgba(t.rgba),d.point.rgba=[t.rgba[0],t.rgba[1],t.rgba[2],t.rgba[3]]),t.rgb&&(t.rgb=d.rgba(t.rgb),d.point.rgba=[t.rgb[0],t.rgb[1],t.rgb[2],255]),t}return d.rgba=function(e,t){return"random"===e?n(t):"randomalpha"===e?n(!0):(void 0!==e[0]&&null!==e[0]||(e[0]=0),void 0!==e[1]&&null!==e[1]||(e[1]=0),void 0!==e[2]&&null!==e[2]||(e[2]=0),void 0!==e[3]&&null!==e[3]||(e[3]=1),"object"==typeof e[0]&&null!=e[0]&&(e[0]=d.randIntSeed(e[0][0],e[0][1])),"object"==typeof e[1]&&null!=e[1]&&(e[1]=d.randIntSeed(e[1][0],e[1][1])),"object"==typeof e[2]&&null!=e[2]&&(e[2]=d.randIntSeed(e[2][0],e[2][1])),"object"==typeof e[3]&&null!=e[3]&&(e[3]=d.randIntSeed(e[3][0],e[3][1])),e[3]%1!=0&&(e[3]=Math.round(255*e[3])),1==e[3]&&(e[3]=255),e)},d.findClosestIndex=function(e,t,r){for(var n=t;0<=n&&n<=e.length-1;n+=r)if(e[n])return n;return e.length-1},d.calc={pi:3.1415927,luminance:function(e){return.21*e[0]+.72*e[1]+.07*e[2]},randomseed:function(e){null==this.seed&&(this.seed=d.randInt(1,16777216)),void 0!==e&&(this.seed=e);var t=1e4*Math.sin(this.seed++);return t-Math.floor(t)},normalize1:function(e){return d.calc.normalize(e,0,1)},normalize:function(e,t,r){return r<e?r:e<t?t:e},pingpong:function(e,t,r){var n=r-t,a=n+n;return e-=Math.floor(e/a)*a,e=n-Math.abs(e-n)},interpolate:{linear:function(e,t,r){return e*(1-r)+t*r},cosine:function(e,t,r){var n=r*d.calc.pi,a=.5*(1-Math.cos(n));return e*(1-a)+t*a},catmullrom:function(e,t,r,n,a,i){var o=a/i,s=n-r-(e-t),l=s*o*o*o+(e-t-s)*o*o+(r-e)*o+t;return l<0&&(l=0),1<l&&(l=1),l}}},d.colormap={data:null,size:255,init:function(e,t,r){if(this.data=null,this.size=null==t?c:t,null==e||null==e)return e;if("object"==typeof e)if("object"==typeof e[0])for(var n in e){var a=e[n];a.rgba=d.rgba(a.rgba),e[n]=a}else e=d.randItem(e);if("random"===e){var i=d.randIntSeed(1,4);e=[];for(var o=0;o<=i;o++)e[o]={percent:parseInt(o/i*100),rgba:[d.randIntSeed(0,255),d.randIntSeed(0,255),d.randIntSeed(0,255),255]}}if("function"==typeof r&&r(e),"string"==typeof e){var s=!1;if("!"==e.charAt(0)&&(e=e.substring(1),s=!0),"function"==typeof u.colormaps[e]){var l=u.colormaps[e](t);this.data=this.render(l,s)}}"object"==typeof e&&(this.data=this.render(e))},render:function(e,t){for(var r=[],n=0;n<e.length-1;n++)for(var a=e[n],i=e[n+1],o=Math.round(this.size*(a.percent/100)),s=Math.round(this.size*(i.percent/100)),l=o;l<=s;l++)r[t?this.size-l:l]=[a.rgba[0]+(l-o)/(s-o)*(i.rgba[0]-a.rgba[0]),a.rgba[1]+(l-o)/(s-o)*(i.rgba[1]-a.rgba[1]),a.rgba[2]+(l-o)/(s-o)*(i.rgba[2]-a.rgba[2]),a.rgba[3]+(l-o)/(s-o)*(i.rgba[3]-a.rgba[3])];return r},get:function(e,t){indexNew=d.calc.pingpong(parseInt(e),0,this.size);var r=this.data[indexNew];return void 0!==t&&(r[3]=t[3]),r}},d.wrapx=function(e){return e&c-1},d.wrapy=function(e){return e&o-1},d.blend=function(e,t,r){return u.blends[e](d,t,r)},d.point={rgba:[],mixed:[],blend:"opacity",colorize:function(e,t,r){return void 0===r&&(r=50),[e[0]-(e[0]-t[0])*(r/100),e[1]-(e[1]-t[1])*(r/100),e[2]-(e[2]-t[2])*(r/100),t[3]?t[3]:255]},opacity:function(e,t){if(255==e[3])return e[3]=t[3],e;if(0==t[3])return t;var r=e[3]/255;return[e[0]*r+t[0]*(1-r),e[1]*r+t[1]*(1-r),e[2]*r+t[2]*(1-r),t[3]]},set:function(e,t){var r=d.texture.get(e,t);switch(void 0!==u.blends[this.blend]?(this.rgba=u.blends[this.blend](d,r,this.rgba),this.mixed=this.opacity(this.rgba,r)):this.mixed=this.rgba,d.normalize){case"clamped":this.mixed[0]=Math.max(0,Math.min(255,this.mixed[0])),this.mixed[1]=Math.max(0,Math.min(255,this.mixed[1])),this.mixed[2]=Math.max(0,Math.min(255,this.mixed[2])),this.mixed[3]=Math.max(0,Math.min(255,this.mixed[3]));break;case"pingpong":this.mixed[0]=d.calc.pingpong(this.mixed[0],0,255),this.mixed[1]=d.calc.pingpong(this.mixed[1],0,255),this.mixed[2]=d.calc.pingpong(this.mixed[2],0,255),this.mixed[3]=d.calc.pingpong(this.mixed[3],0,255)}d.texture.set(e,t,this.mixed)},get:function(e,t,r){return d.texture.get(e,t)}},d.walk=function(e){for(var t=0;t<c;t++)for(var r=0;r<o;r++){var n=d.point.get(t,r);n=e(n,t,r),d.point.rgba=n,d.point.set(t,r)}},d.percent=function(e,t){return parseInt(e/100*t,10)},d.percentX=function(e){return parseInt(e/100*c,10)},d.percentY=function(e){return parseInt(e/100*o,10)},d.percentXY=function(e){return parseInt(e/100*r,10)},d.percentRGBA=function(e,t,r){return t[0]=null===t[0]?e[0]:t[0],t[1]=null===t[1]?e[1]:t[1],t[2]=null===t[2]?e[2]:t[2],t[3]=null===t[3]?e[3]:t[3],[Math.round(e[0]+(t[0]-e[0])*r),Math.round(e[1]+(t[1]-e[1])*r),Math.round(e[2]+(t[2]-e[2])*r),Math.round(e[3]+(t[3]-e[3])*r)]},d.xysize=function(e,t){var r,n,a;return a=null!=t.elements?(r=t.elements[e].x,n=t.elements[e].y,t.elements[e].size):(n="random"==t.origin?(r=d.randIntSeed(0,c),d.randIntSeed(0,o)):(r=t.origin[0],t.origin[1]),d.randByArraySeed(t.size)),{x:r,y:n,size:a}},d.toContext=function(e,t){for(var r=e.createImageData(c,o),n=r.data,a=t.length,i=0;i<a;i+=4)n[i]=t[i],n[i+1]=t[i+1],n[i+2]=t[i+2],n[i+3]=t[i+3];return r},d.toCanvas=function(e){null==e&&(e=d.texture.data);var t=document.createElement("canvas");t.width=c,t.height=o;var r=t.getContext("2d"),n=this.toContext(r,e);return r.putImageData(n,0,0),t},d.getCanvas=function(e){if(e){var t=this.layers[this.layers.length-1];e(this.toCanvas(t))}return this},d.getPhases=function(e){if(e){for(var t=[],r=d.layers.length,n=0;n<r;n++)t.push(this.toCanvas(this.layers[n]));e(t)}return this},d.stat=function(e){return t.stop=(new Date).getTime(),t.elapsed=(t.stop-t.start)/1e3,e&&e(t),this},d.history={available:function(){try{return window&&"localStorage"in window&&null!==window.localStorage&&void 0!==window.localStorage}catch(e){return!1}},list:function(){return this.available()&&JSON.parse(window.localStorage.getItem(u.config.historyName))||[]},last:function(){return this.available()?u.config.historyList[u.config.historyList.length-1]:[]},get:function(e){return this.available()?u.config.historyList[e]?u.config.historyList[e]:null:[]},add:function(e){if(u.config.historyLast){if(!this.available())return[];var t=d.params(e);u.config.historyList=JSON.parse(window.localStorage.getItem(u.config.historyName))||[],u.config.historyList.length>=u.config.historyLast&&u.config.historyList.shift(),u.config.historyList.push(t),window.localStorage.setItem(u.config.historyName,JSON.stringify(u.config.historyList))}}},d.params=function(e){if(null==e){var t=new Date;e=t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()+" l"+d.layers.length+" i"+i.length}return{name:e,version:u.version,width:c,height:o,normalize:d.normalize,items:i}},d.render=function(e,t){this.debug=!0===e.debug,d.event("beforeRender",e);var r=0;for(var n in null!=e.width&&(c=e.width),null!=e.height&&(o=e.height),null!=e.normalize?d.normalize=e.normalize:d.normalize="limitless",s(),d.texture=new d.buffer(e.background),1!=t&&d.clear(),e.items){l=e.items[n][0];var a=e.items[n][1],i=e.items[n][2];"random"==a&&(a=h(d.defaults)),"object"==typeof a&&(a=d.randItem(a)),r!=l&&(null!=d.layers[l]?d.texture.data=d.layers[l]:d.texture.clear(),r=l),null!=d[a]?d[a](i):null!=u.effects[a]?d.do(a,i):console.warn("undefined effect: "+a),d.layers[l]=d.texture.export()}return d.event("afterRender",d.params()),d.history.add(),this},d.event=function(e,t){for(var r in u.events[e]){var n=u.events[e][r];"function"==typeof n&&n(d,t)}},d.do=function(e,t){var r,n,a=t;return void 0===t?t=f({},u.defaults[e]):"object"==typeof t&&(t=f(u.defaults[e],t)),t.seed=t&&void 0!==t.seed&&null!==t.seed?t.seed:[1,16777216],t.seed=d.randByArray(t.seed),t=p(0,t),d.calc.randomseed(t.seed),d.event("beforeEffect",{layer:l,name:e,params:t}),"function"==typeof u.effects[e]?t=u.effects[e](d,t):console.warn("effect not callable: "+e),void 0===t&&(t=a),d.event("afterEffect",{layer:l,name:e,params:t}),t&&!1!==t.store&&(r=e,n=t,i.push([l,r,n])),d},d}};"undefined"!=typeof module&&void 0!==module.exports?module.exports=SeamlessTextureGenerator:"function"==typeof define&&define.amd?define([],function(){return SeamlessTextureGenerator}):window.tgen=SeamlessTextureGenerator,SeamlessTextureGenerator.effect("checkerboard",{blend:SeamlessTextureGenerator.blendFlat,rgba:"randomalpha",even:"random",size:[[2,32],[2,32]]},function(a,e){"random"===e.even&&(e.even=1===a.randInt(0,1));var t,r,i=a.texture.width,o=a.texture.height;"number"==typeof e.size?t=r=e.size:(t="object"==typeof e.size[0]?e.size[0]=a.randByArraySeed(e.size[0],null,!0):e.size[0],r="object"==typeof e.size[1]?e.size[1]=a.randByArraySeed(e.size[1],null,!0):e.size[1]);function n(e,t){for(var r=0;r<s;r++)for(var n=0;n<l;n++)r+e<i&&n+t<o&&a.point.set(r+e,n+t)}for(var s=i/t,l=o/r,c=0;c<t;c++)if(c%2==0)for(var u=0;u<r;u++)n(u%2==0?c*s:c*s+s,u*l);return e}),SeamlessTextureGenerator.effect("circles",{blend:SeamlessTextureGenerator.blendFlat,rgba:"randomalpha",origin:"random",count:[1,42],size:[[1,42],[1,42]],seed:[1,16777216]},function(e,t){"object"==typeof t.size[0]&&(t.size[0]=e.randByArraySeed(t.size[0],!1)),"object"==typeof t.size[1]&&(t.size[1]=e.randByArraySeed(t.size[1],!1));for(var r=0;r<t.count;r++){var n=e.xysize(r,t);e.shape.circle(e,e.percentX(n.x),e.percentY(n.y),e.percentXY(n.size),!0)}return t}),SeamlessTextureGenerator.effect("clouds",{blend:SeamlessTextureGenerator.blendSafe,rgba:"randomalpha",seed:[1,16777216],roughness:[1,32],colormap:null},function(h,p){p.roughness=h.randByArraySeed(p.roughness);function g(e,t,r){return e=Math.round(e),t=Math.round(t),e<0&&(e=b+e),b<=e&&(e-=b),t<0&&(t=y+t),y<=t&&(t-=y),void 0!==r&&(n[e][t]=r),n[e][t]}function m(e){return(h.calc.randomseed()-.5)*(e/(b+b)*p.roughness)}var b=h.texture.width,y=h.texture.height,n=[],v=function(e){var t=e/2;if(t<=1)return p;for(var r=0;r<=b+t;r+=t)for(var n=0;n<=y+t;n+=t){var a=g(r-t,n-t),i=g(r,n-t),o=g(r-t,n),s=g(r,n),l=r-t/2,c=n-t/2,u=g(l,c,h.calc.normalize1((a+i+o+s)/4+m(e))),d=r-e+t/2;g(r-t,c,h.calc.normalize1((a+o+u+g(d,c))/4+m(e)));var f=n-e+t/2;g(l,n-t,h.calc.normalize1((a+i+u+g(l,f))/4+m(e)))}v(t)};h.calc.randomseed(p.seed),function(){for(var e=0;e<=b;e++){n[e]=[];for(var t=0;t<=y;t++)n[e][t]=0}}(),v(b),h.colormap.init(p.colormap,255,function(e){p.colormap=e});for(var e=0;e<b;e++)for(var t=0;t<y;t++){var r=parseInt(255*n[e][t],10);null!==h.colormap.data?h.point.rgba=h.colormap.get(r,p.rgba):h.point.rgba=h.point.colorize(p.rgba,[r,r,r,255]),h.point.set(e,t)}return p}),SeamlessTextureGenerator.effect("colorbar",{type:"random",colormap:"random",mirror:!0},function(e,t){"random"===t.type&&(t.type=1===e.randInt(0,1)?"vertical":"horizontal");var r,n,a,i=e.texture.width,o=e.texture.height,s="horizontal"==t.type?i:o;if(e.colormap.init(t.colormap,s,function(e){t.colormap=e}),"horizontal"==t.type)for(r=0;r<i;r++)for(t.mirror?(a=r<i/2?2*r:2*i-2*r,e.point.rgba=e.colormap.get(a)):e.point.rgba=e.colormap.get(r),n=0;n<o;n++)e.point.set(r,n);else for(n=0;n<o;n++)for(t.mirror?(a=n<o/2?2*n:2*o-2*n,e.point.rgba=e.colormap.get(a)):e.point.rgba=e.colormap.get(n),r=0;r<i;r++)e.point.set(r,n);return t}),SeamlessTextureGenerator.effect("crosshatch",{blend:SeamlessTextureGenerator.blendSafe,rgba:"randomalpha",level:[1,100],xadjust:"random",yadjust:"random"},function(e,t){void 0!==t.xadjust&&"random"!=t.xadjust||(t.xadjust=e.randRealSeed(.1,121)),void 0!==t.yadjust&&"random"!=t.yadjust||(t.yadjust=e.randRealSeed(.1,121)),void 0===t.rgba&&(t.rgba=[e.randIntSeed(0,255),e.randIntSeed(0,255),e.randIntSeed(0,255),255]);for(var r=0;r<e.texture.width;r++)for(var n=0;n<e.texture.height;n++){var a=127+63.5*Math.sin(r*r/t.xadjust)+63.5*Math.cos(n*n/t.yadjust);e.point.rgba=e.point.colorize([a,a,a,255],t.rgba,t.level),e.point.set(r,n)}return t}),SeamlessTextureGenerator.effect("dots",{blend:"opacity",gridX:[2,64],gridY:[2,64],size:[1,250],seed:[1,16777216],rgba:"randomalpha",shape:"sphere",dynamic:!0,xsines:[1,16],ysines:[1,16]},function(e,t){t.gridX=e.randByArray(t.gridX),t.gridY=e.randByArray(t.gridY),void 0===t.xsines?t.xsines=e.randInt(1,10):"object"==typeof t.xsines&&(t.xsines=e.randInt(t.xsines[0],t.xsines[1])),void 0===t.ysines?t.ysines=e.randInt(1,10):"object"==typeof t.ysines&&(t.ysines=e.randInt(t.ysines[0],t.ysines[1]));for(var r=e.randByArraySeed(t.size)/100,n=e.texture.width,a=e.texture.height,i=n/t.gridX,o=a/t.gridY,s=i/2,l=o/2,c=1;c<=t.gridX;c++)for(var u=1;u<=t.gridY;u++){var d=r*(i+o)/2/2,f=d-d/2*Math.sin(c/t.gridX*t.xsines*2*e.calc.pi)+d/2*Math.sin(u/t.gridY*t.ysines*2*e.calc.pi);switch(t.shape){case"sphere":e.shape.sphere(e,c*i-s,u*o-l,2*f,!0,t.rgba,t.dynamic);break;case"pyramid":e.shape.pyramid(e,c*i-s,u*o-l,f,f,!0,t.rgba,t.dynamic);break;case"rect":e.shape.rect(e,c*i-s,u*o-l,f,f,!0,t.rgba,t.dynamic);break;default:f/=2,e.shape.circle(e,c*i-s,u*o-l,f,!0)}}return t}),SeamlessTextureGenerator.effect("fill",{blend:"",rgba:"randomalpha"},function(e,t){return e.shape.rect(e,1,1,e.texture.width,e.texture.height),t}),SeamlessTextureGenerator.effect("mandelbrot",{blend:"opacity",rgba:"randomalpha",seed:[1,16777216],iteration:[8,512],skip:[0,8]},function(e,t){t.skip=e.randByArraySeed(t.skip),t.iteration=e.randByArraySeed(t.iteration);for(var r=e.texture.width,n=e.texture.height,a=t.rgba[0],i=t.rgba[1],o=t.rgba[2],s=256/a,l=256/i,c=256/o,u=t.iteration,d=0,f=0,h=0,p=0,g=0,m=0,b=0;b<n;b++){f=3*b/n-1.5;for(var y=0;y<r;y++){h=d=3*y/r-2,p=f;for(var v=0;v<u&&!(4<(g=h*h)+(m=p*p));v++)p=2*h*p+f,h=g-m+d;v>t.skip&&(e.point.rgba=[v%a*s,v%i*l,v%o*c,e.point.rgba[3]],e.point.set(y,b))}}return t}),SeamlessTextureGenerator.effect("lines",{blend:SeamlessTextureGenerator.blendFlat,rgba:"randomalpha",size:[77,221],count:[21,512],freq1s:[4,221],freq1c:[4,221],freq2s:[4,221],freq2c:[4,221]},function(e,t){t.freq1s=e.randByArraySeed(t.freq1s,!0),t.freq1c=e.randByArraySeed(t.freq1c,!0),t.freq2s=e.randByArraySeed(t.freq2s,!0),t.freq2c=e.randByArraySeed(t.freq2c,!0),t.size=e.randByArraySeed(t.size);for(var r=0;r<t.count;r++){var n=e.texture.width/2+Math.sin(r/t.freq1s*e.calc.pi)*t.size,a=e.texture.height/2+Math.cos(r/t.freq1c*e.calc.pi)*t.size,i=e.texture.width/2+Math.sin(r/t.freq2s*e.calc.pi)*t.size,o=e.texture.height/2+Math.cos(r/t.freq2c*e.calc.pi)*t.size;e.shape.line(e,n,a,i,o)}return t}),SeamlessTextureGenerator.effect("lines2",{blend:SeamlessTextureGenerator.blendFlat,rgba:"randomalpha",type:"random",size:[.1,21],count:[1,42],seed:[1,16777216]},function(e,t){"random"===t.type&&(t.type=1===e.randInt(0,1)?"vertical":"horizontal");for(var r=null,n=0;n<t.count;n++)r=null!=t.elements?t.elements[n]:{size:e.randByArraySeed(t.size,!0),d:e.randRealSeed(.1,100)},"vertical"==t.type?e.shape.rect(e,e.percentX(r.d),0,e.percentX(r.size),e.texture.height):e.shape.rect(e,0,e.percentX(r.d),e.texture.width,e.percentX(r.size));return t}),SeamlessTextureGenerator.effect("noise",{blend:"lighten",mode:"monochrome",channels:[255,255,255],opacity:128,seed:[1,16777216]},function(r,n){switch(n.mode){case"color":r.walk(function(e){return[n.channels[0]?r.randIntSeed(0,n.channels[0]):0,n.channels[1]?r.randIntSeed(0,n.channels[1]):0,n.channels[2]?r.randIntSeed(0,n.channels[2]):0,n.opacity]});break;case"monochrome":r.walk(function(e){var t=r.randIntSeed(0,255);return[t,t,t,n.opacity]});break;case"colorize":r.walk(function(e){return e=r.point.colorize(e,n.rgba)})}return n}),SeamlessTextureGenerator.effect("pyramids",{blend:SeamlessTextureGenerator.blendSafe,rgba:"randomalpha",origin:"random",dynamic:"random",count:[1,77],size:[[1,92],[1,92]],seed:[1,16777216]},function(e,t){"random"===t.dynamic&&(t.dynamic=1===e.randInt(0,1)),"object"==typeof t.size[0]&&(t.size[0]=e.randByArray(t.size[0],!1)),"object"==typeof t.size[1]&&(t.size[1]=e.randByArray(t.size[1],!1));for(var r=0;r<t.count;r++){var n=e.xysize(r,t);e.shape.pyramid(e,e.percentX(n.x),e.percentY(n.y),e.percentXY(n.size),e.percentXY(n.size),!0,t.rgba,t.dynamic)}return t}),SeamlessTextureGenerator.effect("spheres",{blend:SeamlessTextureGenerator.blendSafe,rgba:"randomalpha",origin:"random",dynamic:"random",count:[1,77],size:[[1,92],[1,92]],seed:[1,16777216]},function(e,t){"random"===t.dynamic&&(t.dynamic=1===e.randInt(0,1)),"object"==typeof t.size[0]&&(t.size[0]=e.randByArray(t.size[0],!1)),"object"==typeof t.size[1]&&(t.size[1]=e.randByArray(t.size[1],!1));for(var r=0;r<t.count;r++){var n=e.xysize(r,t);e.shape.sphere(e,e.percentX(n.x),e.percentY(n.y),e.percentXY(n.size),!0,t.rgba,t.dynamic)}return t}),SeamlessTextureGenerator.effect("squares",{blend:SeamlessTextureGenerator.blendFlat,rgba:"randomalpha",origin:"random",count:[1,42],size:[[1,77],[1,77]],seed:[1,16777216]},function(e,t){"object"==typeof t.size[0]&&(t.size[0]=e.randByArraySeed(t.size[0],!1)),"object"==typeof t.size[1]&&(t.size[1]=e.randByArraySeed(t.size[1],!1));for(var r=0;r<t.count;r++){var n=e.xysize(r,t);e.shape.rect(e,e.percentX(n.x),e.percentY(n.y),e.percentXY(n.size),e.percentXY(n.size),!1)}return t}),SeamlessTextureGenerator.effect("subplasma",{seed:[1,16777216],size:[1,7],rgba:"randomalpha"},function(e,t){t.size=e.randByArray(t.size);var r,n,a,i,o,s=1<<t.size,l=e.texture.width,c=l,u=[];l<s&&(s=l);var d=l/s;for(n=0;n<s;n++)for(r=0;r<s;r++)u[r*d+n*d*l]=e.calc.randomseed();for(n=0;n<s;n++)for(r=0;r<l;r++)a=r&~(d-1),u[r+(i=n*d*l)]=e.calc.interpolate.catmullrom(u[(a-d&l-1)+i],u[(a-0*d&l-1)+i],u[(a+d&l-1)+i],u[(a+2*d&l-1)+i],r%d,d);for(n=0;n<c;n++)for(r=0;r<l;r++)a=n&~(d-1),u[r+n*l]=e.calc.interpolate.catmullrom(u[r+(a-d&c-1)*l],u[r+(a-0*d&c-1)*l],u[r+(a+d&c-1)*l],u[r+(a+2*d&c-1)*l],n%d,d);for(r=0;r<e.texture.width;r++)for(n=0;n<e.texture.height;n++)o=255*u[r+n*l],e.point.rgba=e.point.colorize(t.rgba,[o,o,o,255]),e.point.set(r,n);return t}),SeamlessTextureGenerator.effect("waves",{blend:SeamlessTextureGenerator.blendSafe,rgba:"randomalpha",level:[1,100],xsines:[1,14],ysines:[1,14]},function(e,t){if(void 0===t.xsines?t.xsines=e.randIntSeed(1,10):"object"==typeof t.xsines&&(t.xsines=e.randIntSeed(t.xsines[0],t.xsines[1])),void 0===t.ysines?t.ysines=e.randIntSeed(1,10):"object"==typeof t.ysines&&(t.ysines=e.randIntSeed(t.ysines[0],t.ysines[1])),void 0===t.rgba){var r=void 0!==t.opacity?t.opacity:255;t.rgba=e.rgba([[0,255],[0,255],[0,255],r])}for(var n=0;n<e.texture.width;n++)for(var a=0;a<e.texture.height;a++){var i=127+63.5*Math.sin(n/e.texture.width*t.xsines*2*e.calc.pi)+63.5*Math.sin(a/e.texture.height*t.ysines*2*e.calc.pi);"object"==typeof t.channels?e.point.rgba=[t.channels[0]?i:0,t.channels[1]?i:0,t.channels[2]?i:0,t.channels[3]?i:0]:e.point.rgba=e.point.colorize([i,i,i,255],t.rgba,t.level),e.point.set(n,a)}return t}),SeamlessTextureGenerator.effect("xor",{blend:"",rgba:"randomalpha",level:[1,100],zoom:[.1,77]},function(e,t){var r=e.texture.width,n=e.texture.height;void 0===t.zoom?t.zoom=e.randIntSeed(1,10):"object"==typeof t.zoom&&(t.zoom=e.randIntSeed(t.zoom[0],t.zoom[1]));for(var a=0;a<r;a++)for(var i=0;i<n;i++){var o=a*t.zoom^i*t.zoom;e.point.rgba=e.point.colorize([o,o,o,255],t.rgba,t.level),e.point.set(a,i)}return t}),SeamlessTextureGenerator.filter("backlight",{channels:[1,1,1]},function(e,t){return e.walk(function(e){return[t.channels[0]?255/e[0]*(255/e[0]):e[0],t.channels[1]?255/e[1]*(255/e[1]):e[1],t.channels[2]?255/e[2]*(255/e[2]):e[2],e[3]]}),t}),SeamlessTextureGenerator.filter("blur",{},function(e,t){return e.do("convolute",{store:!1,transparent:!1,weights:[1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9]}),t}),SeamlessTextureGenerator.filter("brightness",{adjust:50,legacy:!0},function(e,t){return!0===t.legacy?e.walk(function(e){return[Math.min(e[0]+t.adjust,255),Math.min(e[1]+t.adjust,255),Math.min(e[2]+t.adjust,255),e[3]]}):e.walk(function(e){return[e[0]=Math.min(255/e[0]*(t.adjust/255),255),e[1]=Math.min(255/e[1]*(t.adjust/255),255),e[2]=Math.min(255/e[2]*(t.adjust/255),255),e[3]]}),t}),SeamlessTextureGenerator.filter("channel",{channels:[[.2,.8],[.4,1],[.8,1.2]]},function(e,t){return t.channels[0]=e.randByArray(t.channels[0],!0),t.channels[1]=e.randByArray(t.channels[1],!0),t.channels[2]=e.randByArray(t.channels[2],!0),e.walk(function(e){return[e[0]*t.channels[0],e[1]*t.channels[1],e[2]*t.channels[2],e[3]]}),t}),SeamlessTextureGenerator.filter("colorize",{level:50,rgba:"random",colormap:null},function(n,a){return n.colormap.init(a.colormap,255,function(e){a.colormap=e}),n.walk(function(e){if(n.colormap.data){var t=(e[0]+e[1]+e[2])/3,r=n.colormap.get(t,a.rgba);return r[3]=e[3],r}return n.point.colorize(e,a.rgba,a.level)}),a}),SeamlessTextureGenerator.filter("contrast",{adjust:50},function(e,t){var r=(100+t.adjust)/100;return e.walk(function(e){return e[0]=255*((e[0]/255-.5)*r+.5),e[1]=255*((e[1]/255-.5)*r+.5),e[2]=255*((e[2]/255-.5)*r+.5),[Math.max(Math.min(e[0],255),0),Math.max(Math.min(e[1],255),0),Math.max(Math.min(e[2],255),0),e[3]]}),t}),SeamlessTextureGenerator.filter("convolute",{blend:"opacity",transparent:!1,weights:"default1"},function(e,t){if("object"!=typeof t.weights&&"string"!=typeof t.weights||null==t.weights)return t;if("string"==typeof t.weights[0]&&(t.weights=e.randByArray(t.weights)),"string"==typeof t.weights)if("random"===t.weights){var r=-32;t.weights=[e.randIntSeed(r,32),e.randIntSeed(r,32),e.randIntSeed(r,32),e.randIntSeed(r,32),e.randIntSeed(r,32),e.randIntSeed(r,32),e.randIntSeed(r,32),e.randIntSeed(r,32),e.randIntSeed(r,32),e.randIntSeed(r,32),e.randIntSeed(r,32),e.randIntSeed(r,32)],e.log(t.weights.join(", "))}else{var n={edgedetect1:[-1,-1,-1,-1,8,-1,-1,-1,-1],edgedetect2:[0,1,0,1,-4,1,0,1,0],edgedetect3:[1,0,-1,0,0,0,-1,0,1],sharpen1:[0,-1,0,-1,5,-1,0,-1,0],sharpen2:[-1,-1,-1,-1,9,-1,-1,-1,-1],emboss1:[1,1,1,1,.7,-1,-1,-1,-1],emboss2:[-2,-1,0,-1,1,1,0,1,2],emboss3:[10,3,-2,-8,-5,7,-3,-12,11],emboss4:[-6,11,-9,-9,0,-4,12,8,-2],sobel1:[-1,-2,-1,0,0,0,1,2,1],sobel2:[-1,0,1,-2,0,2,-1,0,1],sobel3:[-5,-8,12,-4,-8,-12,9,6,9],default1:[1,-11,-7,5,2,4,4,9,-2],default2:[-5,-21,25,22,31,-16,-2,-21,-10],default3:[1,1,1,1,1,1,1,1,1]};if(null==n[t.weights])return t;t.weights=n[t.weights]}var a=new e.buffer;a.clear();for(var i=Math.round(Math.sqrt(t.weights.length)),o=Math.floor(i/2),s=t.transparent?1:0,l=0;l<e.texture.height;l++)for(var c=0;c<e.texture.width;c++){for(var u=0,d=0,f=0,h=0,p=0;p<i;p++)for(var g=0;g<i;g++){var m=t.weights[p*i+g],b=l+p-o,y=c+g-o,v=e.texture.get(y,b);u+=v[0]*m,d+=v[1]*m,f+=v[2]*m,h+=v[3]}a.set(c,l,[u,d,f,h+s*(255-h)])}for(var x=e.texture.size();x--;)e.texture.data[x]=a.data[x];return t}),SeamlessTextureGenerator.filter("edgedetect",{type:1},function(e,t){return e.do("convolute",{store:!1,transparent:!1,weights:"edgedetect"+t.type}),t}),SeamlessTextureGenerator.filter("emboss",{type:2},function(e,t){return e.do("convolute",{store:!1,transparent:!1,weights:"emboss"+t.type}),t}),SeamlessTextureGenerator.filter("gamma",{adjust:.5},function(e,t){return e.walk(function(e){return e[0]=255*Math.pow(e[0]/255,1/t.adjust),e[1]=255*Math.pow(e[1]/255,1/t.adjust),e[2]=255*Math.pow(e[2]/255,1/t.adjust),[e[0],e[1],e[2],e[3]]}),t}),SeamlessTextureGenerator.filter("grayscale",{method:["ligthness","average","luminosity"]},function(r,e){switch("string"==typeof e&&(e={method:e}),"object"==typeof e.method&&(e.method=r.randItem(e.method)),e.method){case"ligthness":r.walk(function(e){var t=Math.max(e[0],e[1],e[2])+Math.min(e[0],e[1],e[2]);return[t,t,t,e[3]]});break;case"average":r.walk(function(e){var t=(e[0]+e[1]+e[2])/3;return[t,t,t,e[3]]});break;case"luminosity":r.walk(function(e){var t=r.calc.luminance(e);return[t,t,t,e[3]]})}return e}),SeamlessTextureGenerator.filter("invert",{channels:[1,1,1]},function(e,t){return e.walk(function(e){return[t.channels[0]?255-e[0]:e[0],t.channels[1]?255-e[1]:e[1],t.channels[2]?255-e[2]:e[2],e[3]]}),t}),SeamlessTextureGenerator.filter("opacity",{adjust:128},function(e,t){return e.walk(function(e){return e[3]=t.adjust,e}),t}),SeamlessTextureGenerator.filter("sharpen",{type:2},function(e,t){return e.do("convolute",{store:!1,transparent:!1,weights:"sharpen"+t.type}),t}),SeamlessTextureGenerator.filter("sinecolor",{sines:[1,7],channel:[0,2]},function(r,n){return n.sines=r.randByArray(n.sines),n.channel=r.randByArray(n.channel),r.walk(function(e){var t=parseInt(255*Math.sin(e[n.channel]*(r.calc.pi/180)*(255/360)*n.sines));return e[n.channel]=Math.abs(t),e}),n}),SeamlessTextureGenerator.filter("sobel",{type:3},function(e,t){return e.do("convolute",{store:!1,transparent:!1,weights:"sobel"+t.type}),t}),SeamlessTextureGenerator.filter("threshold",{adjust:[64,128]},function(e,r){return r.adjust=e.randByArray(r.adjust),e.walk(function(e){var t=.2126*e[0]+.7152*e[1]+.0722*e[2]<=r.adjust?0:255;return[t,t,t,e[3]]}),r}),SeamlessTextureGenerator.filter("vibrance",{adjust:128},function(e,t){var a=-1*t.adjust;return e.walk(function(e){var t=(e[0]+e[1]+e[2])/3,r=Math.max(e[0],e[1],e[2]),n=2*Math.abs(r-t)/255*a/100;return e[0]!==r&&(e[0]+=(r-e[0])*n),e[1]!==r&&(e[1]+=(r-e[1])*n),e[2]!==r&&(e[2]+=(r-e[2])*n),[e[0],e[1],e[2],e[3]]}),t}),function(e){e.blend("opacity",function(e,t,r){return r}),e.blend("multiply",function(e,t,r){return r[0]=t[0]*r[0]/255,r[1]=t[1]*r[1]/255,r[2]=t[2]*r[2]/255,r}),e.blend("linearburn",function(e,t,r){return r[0]=t[0]+r[0]-255,r[1]=t[1]+r[1]-255,r[2]=t[2]+r[2]-255,r}),e.blend("difference",function(e,t,r){return r[0]=Math.abs(r[0]-t[0]),r[1]=Math.abs(r[1]-t[1]),r[2]=Math.abs(r[2]-t[2]),r}),e.blend("difference-invert",function(e,t,r){return r[0]=255-Math.abs(r[0]-t[0]),r[1]=255-Math.abs(r[1]-t[1]),r[2]=255-Math.abs(r[2]-t[2]),r}),e.blend("screen",function(e,t,r){return r[0]=255-(255-t[0])*(255-r[0])/255,r[1]=255-(255-t[1])*(255-r[1])/255,r[2]=255-(255-t[2])*(255-r[2])/255,r}),e.blend("overlay",function(e,t,r){return r[0]=128<t[0]?255-2*(255-r[0])*(255-t[0])/255:t[0]*r[0]*2/255,r[1]=128<t[1]?255-2*(255-r[1])*(255-t[1])/255:t[1]*r[1]*2/255,r[2]=128<t[2]?255-2*(255-r[2])*(255-t[2])/255:t[2]*r[2]*2/255,r}),e.blend("exclusion",function(e,t,r){return r[0]=128-2*(t[0]-128)*(r[0]-128)/255,r[1]=128-2*(t[1]-128)*(r[1]-128)/255,r[2]=128-2*(t[2]-128)*(r[2]-128)/255,r}),e.blend("darken",function(e,t,r){return r[0]=r[0]<t[0]?r[0]:t[0],r[1]=r[1]<t[1]?r[1]:t[1],r[2]=r[2]<t[2]?r[2]:t[2],r}),e.blend("lighten",function(e,t,r){return r[0]=r[0]>t[0]?r[0]:t[0],r[1]=r[1]>t[1]?r[1]:t[1],r[2]=r[2]>t[2]?r[2]:t[2],r}),e.blend("lineardodge",function(e,t,r){return r[0]=t[0]+r[0],r[1]=t[1]+r[1],r[2]=t[2]+r[2],r}),e.blend("lineardodge-invert",function(e,t,r){return r[0]=255-(r[0]+t[0]),r[1]=255-(r[1]+t[1]),r[2]=255-(r[2]+t[2]),r}),e.blend("linearlight",function(e,t,r){return r[0]=t[0]+2*r[0]-255,r[1]=t[1]+2*r[1]-255,r[2]=t[2]+2*r[2]-255,r}),e.blend("linearburn",function(e,t,r){return r[0]=t[0]+r[0]-255,r[1]=t[1]+r[1]-255,r[2]=t[2]+r[2]-255,r}),e.blend("softlight",function(e,t,r){return r[0]=128<t[0]?255-(255-t[0])*(255-(r[0]-128))/255:t[0]*(r[0]+128)/255,r[1]=128<t[1]?255-(255-t[1])*(255-(r[1]-128))/255:t[1]*(r[1]+128)/255,r[2]=128<t[2]?255-(255-t[2])*(255-(r[2]-128))/255:t[2]*(r[2]+128)/255,r}),e.blend("subbtract",function(e,t,r){return r[0]=Math.max(t[0]-r[0],0),r[1]=Math.max(t[1]-r[1],0),r[2]=Math.max(t[2]-r[2],0),r}),e.blend("backlight",function(e,t,r){return t[0]=0===t[0]?.01:t[0],t[1]=0===t[1]?.01:t[1],t[2]=0===t[2]?.01:t[2],r[0]=255/t[0]*(255/r[0]),r[1]=255/t[1]*(255/r[1]),r[2]=255/t[2]*(255/r[2]),r}),e.blend("average",function(e,t,r){return r[0]=(r[0]+t[0])/2,r[1]=(r[1]+t[1])/2,r[2]=(r[2]+t[2])/2,r}),e.blend("alphamap",function(e,t,r){return t[3]=(r[0]+r[1]+r[2])/3,t})}(SeamlessTextureGenerator),function(e){e.colormap("blackwhite",function(){return[{percent:0,rgba:[0,0,0,255]},{percent:25,rgba:[255,255,255,255]},{percent:50,rgba:[0,0,0,255]},{percent:75,rgba:[255,255,255,255]},{percent:100,rgba:[0,0,0,255]}]}),e.colormap("dawn",function(){return[{percent:0,rgba:[255,255,192,255]},{percent:25,rgba:[255,255,128,255]},{percent:50,rgba:[255,128,128,255]},{percent:75,rgba:[128,0,128,255]},{percent:100,rgba:[0,0,128,255]}]}),e.colormap("dusk",function(){return[{percent:0,rgba:[255,255,255,255]},{percent:25,rgba:[255,128,255,255]},{percent:50,rgba:[128,0,255,255]},{percent:75,rgba:[0,0,128,255]},{percent:100,rgba:[0,0,0,255]}]}),e.colormap("kryptonite",function(){return[{percent:0,rgba:[255,255,255,255]},{percent:25,rgba:[255,255,128,255]},{percent:50,rgba:[128,255,0,255]},{percent:75,rgba:[0,128,0,255]},{percent:100,rgba:[0,0,0,255]}]}),e.colormap("ice",function(){return[{percent:0,rgba:[255,255,255,255]},{percent:25,rgba:[128,255,255,255]},{percent:50,rgba:[0,128,255,255]},{percent:75,rgba:[0,0,128,255]},{percent:100,rgba:[0,0,0,255]}]}),e.colormap("fire",function(){return[{percent:0,rgba:[255,255,255,255]},{percent:25,rgba:[255,255,128,255]},{percent:50,rgba:[255,128,0,255]},{percent:75,rgba:[128,0,0,255]},{percent:100,rgba:[0,0,0,255]}]}),e.colormap("redblue",function(){return[{percent:0,rgba:[96,0,0,255]},{percent:25,rgba:[192,0,0,255]},{percent:50,rgba:[255,255,255,255]},{percent:75,rgba:[0,0,192,255]},{percent:100,rgba:[0,0,96,255]}]}),e.colormap("seashore",function(){return[{percent:0,rgba:[255,255,192,255]},{percent:25,rgba:[255,255,128,255]},{percent:50,rgba:[128,255,128,255]},{percent:75,rgba:[0,128,128,255]},{percent:100,rgba:[0,0,128,255]}]})}(SeamlessTextureGenerator),function(e){var n,a;e.event("beforeEffect","save start time",function(e,t){n=(new Date).getTime()}),e.event("afterEffect","log",function(e,t){var r=(new Date).getTime()-n;e.log(t.layer,r,t.name,t.params)}),e.event("beforeRender","log",function(e,t){a=(new Date).getTime()}),e.event("afterRender","log",function(e,t){var r=(new Date).getTime()-a;e.log(r,t)})}(SeamlessTextureGenerator),function(e){e.function("copy",{layer:null},function(e,t){return"number"==typeof t&&(t={layer:t}),null===t.layer&&(t.layer=e.layers.length-1),null!=e.layers[t.layer]&&(e.texture.data=e.layerCopy(t.layer)),t}),e.function("mergeall",{blend:"opacity",firstcopy:!0,opacity:null},function(e,t){for(var r=e.layers.length,n=0;n<=r;n++){e.layers[n];0===n&&!0===t.firstcopy?e.do("copy",{layer:0}):e.do("merge",{blend:t.blend,layer:n,opacity:t.opacity})}return t}),e.function("merge",{blend:"opacity",layer:0,opacity:null},function(e,t){if(void 0===e.layers[t.layer])return this;for(var r=e.layers[t.layer],n=0;n<e.texture.height;n++)for(var a=0;a<e.texture.width;a++){var i=e.texture.offset(a,n);e.point.rgba=[r[i],r[i+1],r[i+2],t.opacity?t.opacity:r[i+3]],e.point.set(a,n)}return t}),e.function("map",{xamount:[5,255],yamount:[5,255],xchannel:[0,2],ychannel:[0,2],xlayer:0,ylayer:0},function(e,t){t.xamount=e.randByArray(t.xamount),t.yamount=e.randByArray(t.yamount),t.xchannel=e.randByArray(t.xchannel),t.ychannel=e.randByArray(t.ychannel),t.xlayer=e.randByArray(t.xlayer),t.ylayer=e.randByArray(t.ylayer);for(var r=new e.buffer,n=e.texture.width,a=e.texture.height,i=e.layers[t.xlayer],o=e.layers[t.ylayer],s=0;s<n;s++)for(var l=0;l<a;l++){var c=e.texture.offset(s,l),u=i[c+t.xchannel],d=o[c+t.ychannel];if(n%16==0)var f=e.wrapx(s+(u*t.xamount*n>>16));else f=s+u*t.xamount*n/(n*n);if(a%16==0)var h=e.wrapy(l+(d*t.yamount*a>>16));else h=l+d*t.yamount*a/(a*a);var p=e.point.get(f,h);r.data[c]=p[0],r.data[c+1]=p[1],r.data[c+2]=p[2],r.data[c+3]=p[3]}for(var g=e.texture.size();g--;)e.texture.data[g]=r.data[g];return t})}(SeamlessTextureGenerator),function(e){e.shape("rect",function(e,t,r,n,a,i){void 0!==i&&(t-=parseInt(n/2,10),r-=parseInt(a/2,10));for(var o=0;o<n;o++)for(var s=0;s<a;s++)e.point.set(t+o,r+s)}),e.shape("circle",function(e,t,r,n,a){null==a&&(t+=n,r+=n);for(var i=-n;i<n;i++)for(var o=Math.round(Math.sqrt(n*n-i*i)),s=-o;s<o;s++)e.point.set(t+i,r+s)}),e.shape("line",function(e,t,r,n,a){var i,o=Math.sqrt((n-t)*(n-t)+(a-r)*(a-r)),s=(n-t)/o,l=(a-r)/o,c=0,u=0;for(i=0;i<o;i++)c=t+s*i,u=r+l*i,e.point.set(c,u)}),e.shape("colorLine",function(e,t,r,n,a,i){var o,s,l,c=Math.sqrt((n-t)*(n-t)+(a-r)*(a-r)),u=(n-t)/c,d=(a-r)/c,f=0,h=0,p=i.length;for(l=0;l<c;l++)for(f=t+u*l,h=r+d*l,o=parseInt(p*(l/c)),e.point.rgba=i[o],s=1;s<=7;s++)e.point.set(f-s,h+s)}),e.shape("sphere",function(e,t,r,n,a,i,o){var s,l,c,u,d;for(null==a&&(t+=n,r+=n),u=-n;u<n;u++)for(d=-(c=parseInt(Math.sqrt(n*n-u*u),10));d<c;d++)0<(s=Math.min(255,Math.max(0,255-255*Math.sqrt(d*d+u*u)/(n/2)))/255)&&(l=o?255*s:i[3],e.point.rgba=[i[0]*s,i[1]*s,i[2]*s,l],e.point.set(t+u,r+d))}),e.shape("pyramid",function(e,t,r,n,a,i,o,s){var l,c,u,d,f=parseInt(n/2,10),h=parseInt(a/2,10);for(1!=i&&(t+=f,r+=h),u=-f;u<f;u++)for(d=-h;d<h;d++)1<(l=255*(.25-Math.abs(u/n))+255*(.25-Math.abs(d/a)))&&(c=s?l:o[3],e.point.rgba=[o[0]/255*l,o[1]/255*l,o[2]/255*l,c],e.point.set(t+u,r+d))})}(SeamlessTextureGenerator),function(e){e.effect("test-pattern",{},function(o,e){function t(e,t,r){var n=o.point.get(e,t);for(var a in r)if(r[a]!=n[a]){var i="Not equal : "+e+" : "+t+" "+JSON.stringify(r)+", "+JSON.stringify(n);console.warn(i)}}var r,n=o.texture.width,a=o.texture.height;return o.point.blend="opacity",o.texture.clear([255,255,255,0]),t(0,0,[255,255,255,0]),o.point.rgba=[255,0,0,128],o.point.set(0,0),t(0,0,[255,0,0,128]),o.point.rgba=[0,255,0,128],o.point.set(0,0),t(0,0,[85,170,0,128]),t(0,0,[0,0,0,255]),o.point.rgba=[-1024,1024,128.5,127.6],o.point.set(0,0),t(0,0,[0,128,64,128]),o.texture.clear(),o.point.rgba=[255,0,0,128],o.point.set(0,0),o.point.rgba=[0,255,0,128],o.point.set(0,0),o.point.rgba=[0,0,255,128],o.point.set(0,0),t(0,0,[32,64,128,128]),o.texture.clear([255,255,255,255]),t(0,0,[255,255,255,255]),o.point.rgba=[255,0,0,128],o.point.set(0,0),o.point.rgba=[0,255,0,128],o.point.set(0,0),o.point.rgba=[0,0,255,128],o.point.set(0,0),t(0,0,[63,95,159,128]),o.point.rgba=[0,0,255,128],o.point.set(0,0),t(0,0,[36,73,146,128]),o.texture.clear(),o.point.rgba=[255,255,155,255],o.shape.rect(o,1,1,n-2,a-2),r=20,o.point.rgba=[0,150,0,153],o.shape.rect(o,2,2,r,r),o.shape.rect(o,n-r-2,2,r,r),o.shape.rect(o,2,a-2-r,r,r),o.shape.rect(o,n-2-r,a-2-r,r,r),t(r,r,[102,192,62,153]),o.point.rgba=[20,20,10,51],o.shape.rect(o,n/2,a/2,178,178,!0),t(39,39,[208,208,126,51]),o.point.rgba=[10,20,210,178],o.shape.rect(o,n-5,a-5,10,10),t(2,2,[38,72,165,178]),r=20,o.point.rgba=[10,10,210,250],o.shape.line(o,r,r,n-r,a-r),o.shape.line(o,n-r,r,r,a-r),o.shape.line(o,0,a/2,n,a/2),o.shape.line(o,n/2,0,n/2,a),t(129,127,[208,208,126,51]),t(127,129,[208,208,126,51]),t(236,20,[12,14,11,250]),t(20,20,[12,14,11,250]),t(20,235,[12,14,11,250]),o.point.rgba=[255,55,55,128],o.shape.rect(o,10,10,n-20,a-20),o.point.rgba=[0,0,255,76],o.shape.rect(o,n-2,a-2,4,4),o.point.rgba=[255,255,255,255],o.point.set(0,0),o.point.set(n-1,0),o.point.set(0,a-1),o.point.set(n-1,a-1),o.point.rgba=[25,25,0,51],o.shape.circle(o,n/4,a/4,n/4,!0),o.point.rgba=[255,255,0,25],o.shape.circle(o,n,a,n,!0),o.shape.sphere(o,n/4,a-a/4,n/2,!0,[255,0,0,0],!0),o.shape.sphere(o,n/2,a-a/4,n/2,!0,[0,255,0,0],!0),o.shape.sphere(o,n-n/4,a-a/4,n/2,!0,[255,255,255,0],!0),o.shape.pyramid(o,n-n/4,a/4,n/2,a/2,!0,[0,0,0,255],!0),o.do("brightness",{adjust:50}),o.do("vibrance",{adjust:100}),o.do("contrast",{adjust:20}),e}),e.effect("test-all",{},function(e,t){var r=0;for(var n in e.normalize="clamped",e.do("fill"),e.layers[r++]=e.texture.export(),e.do("waves",{blend:"lighten"}),e.layers[r++]=e.texture.export(),e.do("spheres",{blend:"difference"}),e.layers[r++]=e.texture.export(),e.effects){var a=e.effects[n];"test-all"!=a&&(e.do(a),e.layers[r++]=e.texture.export())}return t})}(SeamlessTextureGenerator);